<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI PropCheck ‚Äî Estim√° la propiedad que quer√©s comprar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React y ReactDOM v√≠a CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  </head>
  <body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script>
      const e = React.createElement;

      /* --- FIX para inputs que pierden foco --- */
      React.useState = React.useState;
      /* --------------------------------------- */

      function Header() {
        return e("header",{className:"sticky top-0 z-10 border-b border-slate-200 bg-white/80 backdrop-blur"},
          e("div",{className:"mx-auto flex max-w-6xl items-center justify-between px-4 py-3"},
            e("div",{className:"flex items-center gap-2"},
              e("div",{className:"grid h-8 w-8 place-items-center rounded-lg bg-blue-600 text-white"},"üè†"),
              e("span",{className:"text-lg font-semibold"},"AI PropCheck")
            ),
            e("nav",{className:"hidden gap-6 md:flex"},
              e("a",{className:"text-sm text-slate-600 hover:text-slate-900",href:"#como"},"C√≥mo funciona"),
              e("a",{className:"text-sm text-slate-600 hover:text-slate-900",href:"#precios"},"Precios")
            )
          )
        )
      }

      function Stat({ label, value, highlight }) {
        return e("div",{className:`rounded-xl border p-4 ${highlight?"border-blue-200 bg-blue-50":"border-slate-200 bg-white"}`},
          e("p",{className:"text-xs uppercase tracking-wide text-slate-500"},label),
          e("p",{className:`mt-1 text-lg font-semibold ${highlight?"text-blue-700":"text-slate-900"}`},value)
        );
      }

      const INITIAL_FORM = {
        calle: "", altura: "", barrio: "",
        piso: "", dpto: "",
        ambientes: "2", m2: "", antiguedad: "0-10",
        cochera: false, seguridad: false,
        amenities: { pileta:false, gym:false, sum:false, parrilla:false },
        estado: "bueno", orientacion: "N",
      };

      function App(){
        const [view,setView]=React.useState("home");
        const [form,setForm]=React.useState(INITIAL_FORM);
        const [report,setReport]=React.useState(null);
        const [errors,setErrors]=React.useState({});

        function setField(name, value){
          setForm(prev=>({...prev,[name]:value}));
        }
        function setAmenity(key, value){
          setForm(prev=>({...prev, amenities:{...prev.amenities,[key]:value}}));
        }

        function validate(){
          const err={};
          if(!form.barrio.trim()) err.barrio="Eleg√≠ un barrio";
          if(!form.calle.trim()) err.calle="Ingres√° la calle";
          if(!form.altura.trim() || isNaN(Number(form.altura))) err.altura="Altura inv√°lida";
          if(!form.m2.trim() || isNaN(Number(form.m2)) || Number(form.m2)<15) err.m2="m¬≤ inv√°lidos";
          return err;
        }

        async function calcular(){
          const err=validate();
          setErrors(err);
          if(Object.keys(err).length) return;

          setView("loading");

          // --- MOCK de resultado ---
          setTimeout(()=>{
            const baseMediana = 160000;
            const m2 = Number(form.m2);
            const amb = Number(form.ambientes);
            const ajusteM2 = (m2-50)*1200;
            const ajusteAmb = (amb-2)*8000;
            const extras = (form.cochera?9000:0) + (form.seguridad?6000:0)
              + (form.amenities.pileta?5000:0) + (form.amenities.gym?3000:0)
              + (form.amenities.sum?2000:0) + (form.amenities.parrilla?1500:0);
            const antig = form.antiguedad==="0-10"?4000:form.antiguedad==="10-30"?0:-5000;
            const pisoAdj = Number(form.piso||"0")>=8?5000:0;

            const median = Math.max(60000, baseMediana + ajusteM2 + ajusteAmb + extras + antig + pisoAdj);
            const q1 = Math.round(median*0.93);
            const q3 = Math.round(median*1.05);

            setReport({
              address:`${form.calle} ${form.altura}, ${form.barrio}`,
              summary:{rooms: amb, sqm: m2, floor: Number(form.piso||"0"), parking: form.cochera},
              estimate:[q1,q3],
              deltaText:`Rango estimado seg√∫n comparables similares`,
              comparables:[
                {id:1,title:`${form.barrio} (¬±10% m¬≤)`,sqm: Math.round(m2*0.95), price: q1, url:"#"},
                {id:2,title:`${form.barrio} (mediana)`,sqm: m2, price: median, url:"#"},
                {id:3,title:`${form.barrio} (top 25%)`,sqm: Math.round(m2*1.05), price: q3, url:"#"},
              ],
              explanation:`Estimaci√≥n basada en tama√±o, ambientes y extras (cochera/seguridad/amenities), comparada con publicaciones similares del barrio.`,
              recommendation:{ text:"Us√° este rango como base y apunt√° a cerrar 5‚Äì10% por debajo del precio listado.", confidence:0.72 }
            });
            setView("result");
          },700);
        }

        function Field({label, error, children}){
          return e("div",null,
            e("label",{className:"mb-1 block text-sm font-medium text-slate-700"},label),
            children,
            error && e("p",{className:"mt-1 text-sm text-red-600"},error)
          );
        }

        return e(React.Fragment,null,
          e(Header),
          e("main",{className:"mx-auto max-w-6xl px-4 pb-24"},
            view==="home" && e("section",{className:"py-10"},
              e("div",{className:"mx-auto grid max-w-4xl gap-8"},
                e("div",{className:"text-center"},
                  e("h1",{className:"text-4xl font-bold leading-tight md:text-5xl"},
                    "¬øCu√°nto deber√≠a valer la propiedad que quer√©s comprar?"
                  ),
                  e("p",{className:"mt-2 text-lg text-slate-600"},
                    "Ingres√° los datos clave y te damos un rango de precio estimado con comparables reales de la zona."
                  )
                ),
                e("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},
                  /* --- FORM FIELDS --- */
                  e("div",{className:"grid gap-4 md:grid-cols-3"},
                    e(Field,{label:"Barrio", error:errors.barrio},
                      e("select",{value:form.barrio,onChange:ev=>setField("barrio",ev.target.value),
                        className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2"},
                        e("option",{value:""},"Eleg√≠ un barrio"),
                        ["Palermo","Belgrano","Caballito","Recoleta","Almagro","Nu√±ez","Villa Urquiza"]
                          .map(b=>e("option",{key:b,value:b},b))
                      )
                    ),
                    e(Field,{label:"Calle", error:errors.calle},
                      e("input",{value:form.calle,onChange:ev=>setField("calle",ev.target.value),
                        placeholder:"Ej. Honduras",className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2"})
                    ),
                    e(Field,{label:"Altura", error:errors.altura},
                      e("input",{value:form.altura,onChange:ev=>setField("altura",ev.target.value),
                        placeholder:"Ej. 4700",className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2"})
                    ),

                    e(Field,{label:"Ambientes"},
                      e("select",{value:form.ambientes,onChange:ev=>setField("ambientes",ev.target.value),
                        className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2"},
                        ["1","2","3","4","5"].map(a=>e("option",{key:a,value:a},`${a}`))
                      )
                    ),
                    e(Field,{label:"Metros cuadrados", error:errors.m2},
                      e("input",{value:form.m2,onChange:ev=>setField("m2",ev.target.value),
                        placeholder:"Ej. 52",className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2"})
                    ),
                    e(Field,{label:"Piso (opcional)"},
                      e("input",{value:form.piso,onChange:ev=>setField("piso",ev.target.value),
                        placeholder:"Ej. 9",className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2"})
                    )
                  ),

                  e("div",{className:"mt-6 flex flex-wrap items-center justify-between gap-3"},
                    e("p",{className:"text-sm text-slate-500"},
                      "Incluye ",e("span",{className:"font-semibold"},"2 estimaciones gratis")," por mes."
                    ),
                    e("button",{onClick:calcular,
                      className:"rounded-xl bg-blue-600 px-6 py-3 font-medium text-white shadow"}, "Calcular estimaci√≥n")
                  )
                )
              )
            ),

            view==="loading" && e("section",{className:"grid place-items-center py-24"},
              e("div",{className:"grid max-w-md gap-4 text-center"},
                e("div",{className:"mx-auto h-12 w-12 animate-spin rounded-full border-4 border-slate-300 border-t-blue-600"}),
                e("p",{className:"text-slate-600"},"Armando comparables y rango estimado‚Ä¶")
              )
            ),

            view==="result" && report && e("section",{className:"py-10"},
              e("div",{className:"mb-6 flex items-center justify-between"},
                e("button",{onClick:()=>setView("home"),className:"text-sm text-blue-600 hover:underline"},"‚Üê Nueva estimaci√≥n")
              ),
              e("div",{className:"grid gap-6 md:grid-cols-3"},
                e("div",{className:"md:col-span-2 grid gap-6"},
                  e("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},
                    e("h2",{className:"text-xl font-semibold"}, report.address),
                    e("div",{className:"mt-4 grid gap-3 md:grid-cols-3"},
                      e(Stat,{label:"Valor estimado (Q1‚ÄìQ3)", value:`US$ ${report.estimate[0].toLocaleString()} ‚Äì ${report.estimate[1].toLocaleString()}`, highlight:true}),
                      e(Stat,{label:"Metodolog√≠a", value:"Comparables por zona + ajustes"}),
                      e(Stat,{label:"Confianza", value:`${Math.round(report.recommendation.confidence*100)}%`})
                    ),
                    e("p",{className:"mt-4 text-slate-700"}, report.explanation)
                  )
                )
              )
            )
          )
        );
      }

      /* --- Render cl√°sico (fix foco teclado) --- */
      ReactDOM.render(React.createElement(App), document.getElementById("root"));
    </script>
  </body>
</html>
